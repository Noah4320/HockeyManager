@model HockeyManager.ViewModel.SearchPlayer

<script src="~/lib/jquery/dist/jquery.js"></script>


<script>
    $(document).ready(function () {
        $("[name='filterDropdown']")
            .change(function () {
                var team = $("#Team").val();
                var favourite = $("#Favourite").val();

                $.ajax({
                    type: "GET",
                    url: "https://localhost:44375/Pool/GetSelectedTeam",
                    data: {
                        team: team,
                        favourite: favourite
                    }
                }).done(function (ManagePoolTeam) {
                    $("#refTable").html(ManagePoolTeam);
                    }).fail(function (x) {
                        alert(x.responseText);

                });
            });

        $(document).on('click', '.playerData', function () {
                var p = $(this).closest('tr');
                copyTable = $('#drafted tbody');
                cloneRow = p.clone();
                copyTable.append(cloneRow)
                p.remove();
        }); 

        $(document).on('click', '#addTeam', function () {
            var poolId = @Context.Request.Query["id"];
            var teamName = $("#teamName").val();
            var playerIds = [];
            $('#drafted tr').each(function () {
                playerIds.push(this.id)

            })
            $.ajax({
                type: "POST",
                url: "https://localhost:44375/Pool/AddTeam",
                data: {
                    id: poolId,
                    name: teamName,
                    players: playerIds
                }
            }).done(function () {

            }).fail(function (x) {
                alert(x.responseText);

            });
        }); 
     }); 
</script>
<div>
    <div class="container">
        <label class="control-label">Team Name:</label>
        <input class="form-control" id="teamName" />
        <span class="text-danger"></span>
    </div>
    <div class="row">
        <div class="col-md-6">
            <h3>Free Agents</h3>
            <label class="control-label">Team:</label>
            <select class="form-control" name="filterDropdown" id="Team">
                <option value=""></option>
                @foreach (var team in Model.Teams)
                {
                    <option id="teamDropdown" value=@team.TeamInfo.Abbreviation>@team.TeamInfo.Name</option>
                }

            </select>

            <label class="control-label">Favourite:</label>
            <select class="form-control" name="filterDropdown" id="Favourite">
                <option value=""></option>
                <option value="Yes">Yes</option>
                <option value="No">No</option>
            </select>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Games Played</th>
                        <th scope="col">Goals</th>
                        <th scope="col">Assists</th>
                        <th scope="col">Points</th>
                    </tr>
                </thead>
                <tbody id="refTable">
                    <partial name="_PlayerData" model="Model.Players" />
                </tbody>
            </table>
        </div>
        <div class="col-md-6">
            <h3>My Roster</h3>
            <table id="drafted" class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Games Played</th>
                        <th scope="col">Goals</th>
                        <th scope="col">Assists</th>
                        <th scope="col">Points</th>
                    </tr>
                </thead>
                <tbody>
              
                </tbody>
            </table>
            <button id="addTeam" onclick="location.href='@Url.Action("Details", "Pool", new { id = @Context.Request.Query["id"]})'" >Add Team</button>
        </div>
    </div>
</div>